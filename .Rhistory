#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p24$PercentAbundance<-p24$totalAb/sum(p24$totalAb)
# p24<-p24 %>% arrange(desc(PercentAbundance))
# tenp24<-p24[1:10,]
# tenp24$Barcode<-rep(24,10)
#
# tensed<-rbind(tenp21,tenp22,tenp23,tenp24)
# unique(tensed)
#
# ggplot(tensed, aes(fill=Phylum,y=PercentAbundance,x=Barcode)) +
#   geom_col(position="fill") +
#   scale_fill_manual(values=c("red","orange","yellow","green","blue","cyan","purple","magenta","grey","pink","black","white","brown")) +
#   scale_y_continuous(labels = scales::percent) +
#   labs(x="Barcode",y="Percent Abundance of Phylum") +
#   theme_minimal()
#
# TOP THREE GENUS
s21<-Sed21 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s21$PercentAbundance<-s21$totalAb/sum(s21$totalAb)
s21<-s21 %>% arrange(desc(PercentAbundance))
threes21<-s21[1:3,]
threes21$Barcode<-rep(21,3)
s22<-Sed22 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s22$PercentAbundance<-s22$totalAb/sum(s22$totalAb)
s22<-s22 %>% arrange(desc(PercentAbundance))
threes22<-s22[1:3,]
threes22$Barcode<-rep(22,3)
s23<-Sed23 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s23$PercentAbundance<-s23$totalAb/sum(s23$totalAb)
s23<-s23 %>% arrange(desc(PercentAbundance))
threes23<-s23[1:3,]
threes23$Barcode<-rep(23,3)
s24<-Sed24 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s24$PercentAbundance<-s24$totalAb/sum(s24$totalAb)
s24<-s24 %>% arrange(desc(PercentAbundance))
threes24<-s24[1:3,]
threes24$Barcode<-rep(24,3)
#kajshdflajkshdfasdf
s25<-Sed25 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s25$PercentAbundance<-s25$totalAb/sum(s25$totalAb)
s25<-s25 %>% arrange(desc(PercentAbundance))
threes25<-s25[1:3,]
threes25$Barcode<-rep(25,3)
s26<-Sed26 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s26$PercentAbundance<-s26$totalAb/sum(s26$totalAb)
s26<-s26 %>% arrange(desc(PercentAbundance))
threes26<-s26[1:3,]
threes26$Barcode<-rep(26,3)
s30<-Sed30 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s30$PercentAbundance<-s30$totalAb/sum(s30$totalAb)
s30<-s30 %>% arrange(desc(PercentAbundance))
threes30<-s30[1:3,]
threes30$Barcode<-rep(30,3)
s31<-Sed31 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s31$PercentAbundance<-s31$totalAb/sum(s31$totalAb)
s31<-s31 %>% arrange(desc(PercentAbundance))
threes31<-s31[1:3,]
threes31$Barcode<-rep(31,3)
s32<-Sed32 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s32$PercentAbundance<-s32$totalAb/sum(s32$totalAb)
s32<-s32 %>% arrange(desc(PercentAbundance))
threes32<-s32[1:3,]
threes32$Barcode<-rep(32,3)
tensed<-rbind(threes21,threes22,threes23,threes24,threes25,threes26,threes30,threes31,threes32)
unique(tensed)
ggplot(tensed, aes(fill=Genus,y=PercentAbundance,x=as.factor(`Barcode`))) +
geom_bar(position="dodge", stat="identity") +
scale_fill_manual(values=c("#252525","#004949","#009999","#22cf22","#490092","#006ddb","#b66dff","#ff6db6","#920000","#db6d00","#ffdf4d")) +
# scale_y_continuous(labels = scales::percent) +
labs(x="Barcode",y="Percent Abundance of Genus") +
theme_minimal()
# tiff("top3Genus.tiff", units="in", width=7, height=4, res=400)
# tensed
# dev.off()
# TOP 3 genus and look at what the genus are
# p21<-Sed21 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p21$PercentAbundance<-p21$totalAb/sum(p21$totalAb)
# # unique(p21$Phylum)
# p21<-p21 %>% arrange(desc(PercentAbundance))
# tenp21<-p21[1:10,]
# tenp21$Barcode<-rep(21,10)
#
# p22<-Sed22 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p22$PercentAbundance<-p22$totalAb/sum(p22$totalAb)
# p22<-p22 %>% arrange(desc(PercentAbundance))
# tenp22<-p22[1:10,]
# tenp22$Barcode<-rep(22,10)
#
# p23<-Sed23 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p23$PercentAbundance<-p23$totalAb/sum(p23$totalAb)
# p23<-p23 %>% arrange(desc(PercentAbundance))
# tenp23<-p23[1:10,]
# tenp23$Barcode<-rep(23,10)
#
# p24<-Sed24 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p24$PercentAbundance<-p24$totalAb/sum(p24$totalAb)
# p24<-p24 %>% arrange(desc(PercentAbundance))
# tenp24<-p24[1:10,]
# tenp24$Barcode<-rep(24,10)
#
# tensed<-rbind(tenp21,tenp22,tenp23,tenp24)
# unique(tensed)
#
# ggplot(tensed, aes(fill=Phylum,y=PercentAbundance,x=Barcode)) +
#   geom_col(position="fill") +
#   scale_fill_manual(values=c("red","orange","yellow","green","blue","cyan","purple","magenta","grey","pink","black","white","brown")) +
#   scale_y_continuous(labels = scales::percent) +
#   labs(x="Barcode",y="Percent Abundance of Phylum") +
#   theme_minimal()
#
# TOP THREE GENUS
s21<-Sed21 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s21$PercentAbundance<-s21$totalAb/sum(s21$totalAb)
s21<-s21 %>% arrange(desc(PercentAbundance))
threes21<-s21[1:3,]
threes21$Barcode<-rep(21,3)
s22<-Sed22 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s22$PercentAbundance<-s22$totalAb/sum(s22$totalAb)
s22<-s22 %>% arrange(desc(PercentAbundance))
threes22<-s22[1:3,]
threes22$Barcode<-rep(22,3)
s23<-Sed23 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s23$PercentAbundance<-s23$totalAb/sum(s23$totalAb)
s23<-s23 %>% arrange(desc(PercentAbundance))
threes23<-s23[1:3,]
threes23$Barcode<-rep(23,3)
s24<-Sed24 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s24$PercentAbundance<-s24$totalAb/sum(s24$totalAb)
s24<-s24 %>% arrange(desc(PercentAbundance))
threes24<-s24[1:3,]
threes24$Barcode<-rep(24,3)
#kajshdflajkshdfasdf
s25<-Sed25 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s25$PercentAbundance<-s25$totalAb/sum(s25$totalAb)
s25<-s25 %>% arrange(desc(PercentAbundance))
threes25<-s25[1:3,]
threes25$Barcode<-rep(25,3)
s26<-Sed26 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s26$PercentAbundance<-s26$totalAb/sum(s26$totalAb)
s26<-s26 %>% arrange(desc(PercentAbundance))
threes26<-s26[1:3,]
threes26$Barcode<-rep(26,3)
s30<-Sed30 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s30$PercentAbundance<-s30$totalAb/sum(s30$totalAb)
s30<-s30 %>% arrange(desc(PercentAbundance))
threes30<-s30[1:3,]
threes30$Barcode<-rep(30,3)
s31<-Sed31 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s31$PercentAbundance<-s31$totalAb/sum(s31$totalAb)
s31<-s31 %>% arrange(desc(PercentAbundance))
threes31<-s31[1:3,]
threes31$Barcode<-rep(31,3)
s32<-Sed32 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s32$PercentAbundance<-s32$totalAb/sum(s32$totalAb)
s32<-s32 %>% arrange(desc(PercentAbundance))
threes32<-s32[1:3,]
threes32$Barcode<-rep(32,3)
tensed<-rbind(threes21,threes22,threes23,threes24,threes25,threes26,threes30,threes31,threes32)
unique(tensed)
ggplot(tensed, aes(fill=Genus,y=PercentAbundance,x=as.factor(`Barcode`))) +
geom_bar(position="dodge", stat="identity") +
scale_fill_manual(values=c("#252525","#004901","#009999","#22cf22","#490092","#006ddb","#b66dff","#ff6db6","#920000","#db6d00","#ffdf4d")) +
# scale_y_continuous(labels = scales::percent) +
labs(x="Barcode",y="Percent Abundance of Genus") +
theme_minimal()
# tiff("top3Genus.tiff", units="in", width=7, height=4, res=400)
# tensed
# dev.off()
# TOP 3 genus and look at what the genus are
# p21<-Sed21 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p21$PercentAbundance<-p21$totalAb/sum(p21$totalAb)
# # unique(p21$Phylum)
# p21<-p21 %>% arrange(desc(PercentAbundance))
# tenp21<-p21[1:10,]
# tenp21$Barcode<-rep(21,10)
#
# p22<-Sed22 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p22$PercentAbundance<-p22$totalAb/sum(p22$totalAb)
# p22<-p22 %>% arrange(desc(PercentAbundance))
# tenp22<-p22[1:10,]
# tenp22$Barcode<-rep(22,10)
#
# p23<-Sed23 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p23$PercentAbundance<-p23$totalAb/sum(p23$totalAb)
# p23<-p23 %>% arrange(desc(PercentAbundance))
# tenp23<-p23[1:10,]
# tenp23$Barcode<-rep(23,10)
#
# p24<-Sed24 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p24$PercentAbundance<-p24$totalAb/sum(p24$totalAb)
# p24<-p24 %>% arrange(desc(PercentAbundance))
# tenp24<-p24[1:10,]
# tenp24$Barcode<-rep(24,10)
#
# tensed<-rbind(tenp21,tenp22,tenp23,tenp24)
# unique(tensed)
#
# ggplot(tensed, aes(fill=Phylum,y=PercentAbundance,x=Barcode)) +
#   geom_col(position="fill") +
#   scale_fill_manual(values=c("red","orange","yellow","green","blue","cyan","purple","magenta","grey","pink","black","white","brown")) +
#   scale_y_continuous(labels = scales::percent) +
#   labs(x="Barcode",y="Percent Abundance of Phylum") +
#   theme_minimal()
#
# TOP THREE GENUS
s21<-Sed21 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s21$PercentAbundance<-s21$totalAb/sum(s21$totalAb)
s21<-s21 %>% arrange(desc(PercentAbundance))
threes21<-s21[1:3,]
threes21$Barcode<-rep(21,3)
s22<-Sed22 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s22$PercentAbundance<-s22$totalAb/sum(s22$totalAb)
s22<-s22 %>% arrange(desc(PercentAbundance))
threes22<-s22[1:3,]
threes22$Barcode<-rep(22,3)
s23<-Sed23 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s23$PercentAbundance<-s23$totalAb/sum(s23$totalAb)
s23<-s23 %>% arrange(desc(PercentAbundance))
threes23<-s23[1:3,]
threes23$Barcode<-rep(23,3)
s24<-Sed24 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s24$PercentAbundance<-s24$totalAb/sum(s24$totalAb)
s24<-s24 %>% arrange(desc(PercentAbundance))
threes24<-s24[1:3,]
threes24$Barcode<-rep(24,3)
#kajshdflajkshdfasdf
s25<-Sed25 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s25$PercentAbundance<-s25$totalAb/sum(s25$totalAb)
s25<-s25 %>% arrange(desc(PercentAbundance))
threes25<-s25[1:3,]
threes25$Barcode<-rep(25,3)
s26<-Sed26 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s26$PercentAbundance<-s26$totalAb/sum(s26$totalAb)
s26<-s26 %>% arrange(desc(PercentAbundance))
threes26<-s26[1:3,]
threes26$Barcode<-rep(26,3)
s30<-Sed30 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s30$PercentAbundance<-s30$totalAb/sum(s30$totalAb)
s30<-s30 %>% arrange(desc(PercentAbundance))
threes30<-s30[1:3,]
threes30$Barcode<-rep(30,3)
s31<-Sed31 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s31$PercentAbundance<-s31$totalAb/sum(s31$totalAb)
s31<-s31 %>% arrange(desc(PercentAbundance))
threes31<-s31[1:3,]
threes31$Barcode<-rep(31,3)
s32<-Sed32 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s32$PercentAbundance<-s32$totalAb/sum(s32$totalAb)
s32<-s32 %>% arrange(desc(PercentAbundance))
threes32<-s32[1:3,]
threes32$Barcode<-rep(32,3)
tensed<-rbind(threes21,threes22,threes23,threes24,threes25,threes26,threes30,threes31,threes32)
unique(tensed)
ggplot(tensed, aes(fill=Genus,y=PercentAbundance,x=as.factor(`Barcode`))) +
geom_bar(position="dodge", stat="identity") +
scale_fill_manual(values=c("#252540","#004900","#009999","#22cf22","#490092","#006ddb","#b66dff","#ff6db6","#920000","#db6d00","#ffdf4d")) +
# scale_y_continuous(labels = scales::percent) +
labs(x="Barcode",y="Percent Abundance of Genus") +
theme_minimal()
# tiff("top3Genus.tiff", units="in", width=7, height=4, res=400)
# tensed
# dev.off()
# TOP 3 genus and look at what the genus are
tiff("top3Genus.tiff", units="in", width=7, height=4, res=400)
ggplot(tensed, aes(fill=Genus,y=PercentAbundance,x=as.factor(`Barcode`))) +
geom_bar(position="dodge", stat="identity") +
scale_fill_manual(values=c("#252540","#004900","#009999","#22cf22","#490092","#006ddb","#b66dff","#ff6db6","#920000","#db6d00","#ffdf4d")) +
# scale_y_continuous(labels = scales::percent) +
labs(x="Barcode",y="Percent Abundance of Genus") +
theme_minimal()
dev.off()
tensed<-rbind(threes21,threes22,threes23,threes24,threes25,threes26,threes30,threes31,threes32)
unique(tensed)
# p21<-Sed21 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p21$PercentAbundance<-p21$totalAb/sum(p21$totalAb)
# # unique(p21$Phylum)
# p21<-p21 %>% arrange(desc(PercentAbundance))
# tenp21<-p21[1:10,]
# tenp21$Barcode<-rep(21,10)
#
# p22<-Sed22 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p22$PercentAbundance<-p22$totalAb/sum(p22$totalAb)
# p22<-p22 %>% arrange(desc(PercentAbundance))
# tenp22<-p22[1:10,]
# tenp22$Barcode<-rep(22,10)
#
# p23<-Sed23 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p23$PercentAbundance<-p23$totalAb/sum(p23$totalAb)
# p23<-p23 %>% arrange(desc(PercentAbundance))
# tenp23<-p23[1:10,]
# tenp23$Barcode<-rep(23,10)
#
# p24<-Sed24 %>%
#     group_by(Phylum) %>%
#     summarise(num = n(),
#     totalAb = sum(Abundance))
# p24$PercentAbundance<-p24$totalAb/sum(p24$totalAb)
# p24<-p24 %>% arrange(desc(PercentAbundance))
# tenp24<-p24[1:10,]
# tenp24$Barcode<-rep(24,10)
#
# tensed<-rbind(tenp21,tenp22,tenp23,tenp24)
# unique(tensed)
#
# ggplot(tensed, aes(fill=Phylum,y=PercentAbundance,x=Barcode)) +
#   geom_col(position="fill") +
#   scale_fill_manual(values=c("red","orange","yellow","green","blue","cyan","purple","magenta","grey","pink","black","white","brown")) +
#   scale_y_continuous(labels = scales::percent) +
#   labs(x="Barcode",y="Percent Abundance of Phylum") +
#   theme_minimal()
#
# TOP THREE GENUS
s21<-Sed21 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s21$PercentAbundance<-s21$totalAb/sum(s21$totalAb)
s21<-s21 %>% arrange(desc(PercentAbundance))
threes21<-s21[1:3,]
threes21$Barcode<-rep(21,3)
s22<-Sed22 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s22$PercentAbundance<-s22$totalAb/sum(s22$totalAb)
s22<-s22 %>% arrange(desc(PercentAbundance))
threes22<-s22[1:3,]
threes22$Barcode<-rep(22,3)
s23<-Sed23 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s23$PercentAbundance<-s23$totalAb/sum(s23$totalAb)
s23<-s23 %>% arrange(desc(PercentAbundance))
threes23<-s23[1:3,]
threes23$Barcode<-rep(23,3)
s24<-Sed24 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s24$PercentAbundance<-s24$totalAb/sum(s24$totalAb)
s24<-s24 %>% arrange(desc(PercentAbundance))
threes24<-s24[1:3,]
threes24$Barcode<-rep(24,3)
#kajshdflajkshdfasdf
s25<-Sed25 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s25$PercentAbundance<-s25$totalAb/sum(s25$totalAb)
s25<-s25 %>% arrange(desc(PercentAbundance))
threes25<-s25[1:3,]
threes25$Barcode<-rep(25,3)
s26<-Sed26 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s26$PercentAbundance<-s26$totalAb/sum(s26$totalAb)
s26<-s26 %>% arrange(desc(PercentAbundance))
threes26<-s26[1:3,]
threes26$Barcode<-rep(26,3)
s30<-Sed30 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s30$PercentAbundance<-s30$totalAb/sum(s30$totalAb)
s30<-s30 %>% arrange(desc(PercentAbundance))
threes30<-s30[1:3,]
threes30$Barcode<-rep(30,3)
s31<-Sed31 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s31$PercentAbundance<-s31$totalAb/sum(s31$totalAb)
s31<-s31 %>% arrange(desc(PercentAbundance))
threes31<-s31[1:3,]
threes31$Barcode<-rep(31,3)
s32<-Sed32 %>%
group_by(Genus) %>%
summarise(num = n(),
totalAb = sum(Abundance))
s32$PercentAbundance<-s32$totalAb/sum(s32$totalAb)
s32<-s32 %>% arrange(desc(PercentAbundance))
threes32<-s32[1:3,]
threes32$Barcode<-rep(32,3)
tensed<-rbind(threes21,threes22,threes23,threes24,threes25,threes26,threes30,threes31,threes32)
unique(tensed$Genus)
tiff("top3Genus.tiff", units="in", width=7, height=4, res=400)
ggplot(tensed, aes(fill=Genus,y=PercentAbundance,x=as.factor(`Barcode`))) +
geom_bar(position="dodge", stat="identity") +
scale_fill_manual(values=c("#252540","#004900","#009999","#22cf22","#490092","#006ddb","#b66dff","#ff6db6","#920000","#db6d00","#ffdf4d")) +
# scale_y_continuous(labels = scales::percent) +
labs(x="Barcode",y="Percent Abundance of Genus") +
theme_minimal()
dev.off()
# TOP 3 genus and look at what the genus are
